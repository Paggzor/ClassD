Version 4
SHEET 1 1960 1232
WIRE -2048 -272 -2048 -320
WIRE -2048 -176 -2048 -192
WIRE -1808 -176 -2048 -176
WIRE -1648 -176 -1808 -176
WIRE -1504 -176 -1568 -176
WIRE -2048 -144 -2048 -176
WIRE 976 -128 560 -128
WIRE 1376 -128 1056 -128
WIRE 1440 -128 1376 -128
WIRE 560 -96 560 -128
WIRE 1440 -80 1440 -128
WIRE 384 0 240 0
WIRE 480 0 384 0
WIRE 256 32 240 32
WIRE 256 48 256 32
WIRE 480 48 256 48
WIRE 560 48 560 32
WIRE 560 48 480 48
WIRE 672 48 560 48
WIRE 688 48 672 48
WIRE 784 48 768 48
WIRE 800 48 784 48
WIRE 896 48 880 48
WIRE 992 48 896 48
WIRE 1040 48 992 48
WIRE 1104 48 1040 48
WIRE 1248 48 1168 48
WIRE 1440 48 1440 0
WIRE 1440 48 1328 48
WIRE -1136 64 -1216 64
WIRE -896 64 -1056 64
WIRE 256 64 256 48
WIRE 256 64 240 64
WIRE 1440 64 1440 48
WIRE 992 80 992 48
WIRE -1696 96 -1696 32
WIRE 256 96 256 64
WIRE 256 96 240 96
WIRE -1024 128 -1024 112
WIRE -992 128 -1024 128
WIRE 256 128 256 96
WIRE 256 128 240 128
WIRE -1808 144 -1808 -176
WIRE -1728 144 -1808 144
WIRE -1024 144 -1024 128
WIRE -992 144 -992 128
WIRE -896 144 -896 64
WIRE -768 144 -896 144
WIRE -208 144 -768 144
WIRE 672 144 672 48
WIRE 256 160 256 128
WIRE 256 160 240 160
WIRE 560 160 560 48
WIRE 1904 160 1904 80
WIRE -1504 176 -1504 -176
WIRE -1504 176 -1584 176
WIRE -1456 176 -1504 176
WIRE -1360 176 -1456 176
WIRE -1264 176 -1280 176
WIRE -1248 176 -1264 176
WIRE -1216 176 -1216 64
WIRE -1216 176 -1248 176
WIRE -1040 176 -1184 176
WIRE -208 176 -208 144
WIRE -144 176 -208 176
WIRE -896 192 -896 144
WIRE -896 192 -960 192
WIRE -2672 208 -2768 208
WIRE -2352 208 -2672 208
WIRE -1920 208 -2288 208
WIRE -1760 208 -1920 208
WIRE -1728 208 -1760 208
WIRE -1216 208 -1216 176
WIRE -1040 208 -1216 208
WIRE 992 208 992 144
WIRE 672 224 672 208
WIRE -2768 256 -2768 208
WIRE 352 256 240 256
WIRE 480 256 352 256
WIRE -1696 288 -1696 256
WIRE -1648 288 -1648 256
WIRE 272 288 240 288
WIRE -1920 304 -1920 208
WIRE -1760 304 -1760 208
WIRE -1264 320 -1264 176
WIRE 272 320 272 288
WIRE 272 320 240 320
WIRE -1024 336 -1024 240
WIRE -992 336 -992 240
WIRE -992 336 -1024 336
WIRE 272 336 272 320
WIRE 480 336 480 320
WIRE 480 336 272 336
WIRE 560 336 560 288
WIRE 560 336 480 336
WIRE 672 336 672 304
WIRE 672 336 560 336
WIRE -1024 352 -1024 336
WIRE 272 352 272 336
WIRE 272 352 240 352
WIRE 560 400 560 336
WIRE -1264 432 -1264 384
WIRE -2768 448 -2768 336
WIRE -1920 448 -1920 384
WIRE -1760 448 -1760 384
WIRE -1760 448 -1920 448
WIRE 688 464 672 464
WIRE 704 464 688 464
WIRE 784 496 784 48
WIRE 896 496 896 48
WIRE 672 560 672 464
WIRE 784 576 784 496
WIRE 784 576 720 576
WIRE -2048 592 -2048 -64
WIRE -1760 608 -1760 448
WIRE -1264 608 -1264 512
WIRE -1184 608 -1184 176
WIRE 368 608 -1184 608
WIRE 512 608 368 608
WIRE 592 608 512 608
WIRE 896 640 896 496
WIRE 896 640 720 640
WIRE 672 720 672 656
WIRE -2768 752 -2768 528
WIRE -2048 752 -2048 672
WIRE -1760 768 -1760 688
WIRE 512 832 512 688
WIRE 512 960 512 912
FLAG 1440 64 0
FLAG 992 208 0
FLAG 560 400 0
FLAG 1904 240 0
FLAG 1904 80 5V
FLAG -1024 112 5V
FLAG -1024 352 0
FLAG 512 960 0
FLAG -1696 288 0
FLAG -1648 288 0
FLAG -1696 32 5V
FLAG 1040 48 Vfb
FLAG -2048 -320 Vfb
FLAG -1760 768 0
FLAG 480 48 Sw
FLAG -768 144 PWM
FLAG -1456 176 EA
FLAG -2672 208 Vin
FLAG 672 720 0
FLAG 368 608 sens
FLAG 384 0 Tg
FLAG 352 256 Bg
FLAG 784 496 Curr+
FLAG 896 496 Curr-
FLAG 1376 -128 Vcc
FLAG 688 464 Vcc
FLAG -1264 608 0
FLAG -1248 176 VP
FLAG -2048 752 0
FLAG -2768 752 0
DATAFLAG 544 608 ""
DATAFLAG -2624 208 ""
SYMBOL ind 672 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 500n
SYMBOL voltage 1440 -96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 40
SYMBOL cap 976 80 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res 896 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10m
SYMBOL voltage 1904 144 R0
SYMATTR InstName V5
SYMATTR Value 5V
SYMBOL voltage 512 816 R0
SYMATTR InstName V4
SYMATTR Value 2.5V
SYMBOL res 1344 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 3
SYMBOL Opamps\\LT6236 -1696 176 R0
SYMATTR InstName U3
SYMBOL res -2064 -288 R0
SYMATTR InstName R2
SYMATTR Value 190k
SYMBOL res -1664 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value {10k*gm1}
SYMBOL voltage -2768 240 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(2.5 0.5 50k)
SYMBOL res -1744 400 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -2064 -160 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL voltage -2768 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PWL(10u 0 11u -4v 12u 4v 13u -4 14u 4 15u 0)
SYMBOL voltage -1760 592 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 2.5V
SYMBOL current-amp 672 624 M0
SYMATTR InstName X1
SYMBOL res 496 592 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -1264 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL EPCGaN 480 0 R0
SYMATTR InstName U1
SYMATTR Value EPC2214
SYMBOL EPCGaN 480 256 R0
SYMATTR InstName U2
SYMATTR Value EPC2214
SYMBOL LMG1210-simple 48 0 R0
SYMATTR InstName X2
SYMBOL res 960 -144 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10m
SYMBOL cap 656 144 R0
SYMATTR InstName C2
SYMATTR Value 10p
SYMBOL res 656 208 R0
SYMATTR InstName R4
SYMATTR Value 10
SYMBOL res -1040 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1Meg
SYMBOL Comparators\\LT1715 -1008 192 R0
SYMATTR InstName U4
SYMBOL schottky -1248 384 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage -1264 416 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 2
SYMBOL cap 1168 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res -1936 288 R0
SYMATTR InstName R6
SYMATTR Value 190k
SYMBOL voltage -2048 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 1.5789
SYMBOL cap -2288 192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
TEXT -656 408 Left 2 !.tran 0 100u 0 uic
TEXT -664 432 Left 2 !.lib opamp.sub
TEXT -664 472 Left 2 !.param gm1=20
TEXT -1144 -56 Left 2 ;gm_comp = 1/rm = 10 A/V
TEXT -1136 -8 Left 2 ;gm_tot = A-fb * gm_comp
TEXT 648 784 Left 2 ;Iout 1mA (gm*0.1) @ Vsens-max 100mV -> \nR7=1k.  Imax =>1V:  \n \nR1 = Vsens-max / Imax = 0.1V / 10A = 10mOhm
