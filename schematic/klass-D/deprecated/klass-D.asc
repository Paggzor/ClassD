Version 4
SHEET 1 1624 1232
WIRE -1952 -96 -1952 -144
WIRE 992 -32 256 -32
WIRE -1952 0 -1952 -16
WIRE -1808 0 -1952 0
WIRE -1648 0 -1808 0
WIRE -1504 0 -1568 0
WIRE 256 16 256 -32
WIRE 256 16 224 16
WIRE 992 16 992 -32
WIRE -1952 32 -1952 0
WIRE -432 48 -448 48
WIRE -336 48 -352 48
WIRE -208 48 -336 48
WIRE 16 48 -16 48
WIRE -1136 64 -1168 64
WIRE -896 64 -1056 64
WIRE -336 80 -336 48
WIRE -320 80 -336 80
WIRE -208 80 -240 80
WIRE -1696 96 -1696 64
WIRE 176 96 -16 96
WIRE 192 96 176 96
WIRE 352 112 320 112
WIRE 448 112 432 112
WIRE 560 112 528 112
WIRE 656 112 560 112
WIRE 704 112 656 112
WIRE 752 112 704 112
WIRE -1952 144 -1952 112
WIRE -1808 144 -1808 0
WIRE -1728 144 -1808 144
WIRE -1024 144 -1024 112
WIRE -896 144 -896 64
WIRE -768 144 -896 144
WIRE -432 144 -768 144
WIRE -208 144 -352 144
WIRE 80 144 80 48
WIRE 80 144 -16 144
WIRE 144 144 80 144
WIRE 224 144 224 112
WIRE 224 144 144 144
WIRE 320 144 320 112
WIRE 320 144 224 144
WIRE 752 144 752 112
WIRE 800 144 752 144
WIRE 992 144 992 96
WIRE 992 144 880 144
WIRE -1504 176 -1504 0
WIRE -1504 176 -1584 176
WIRE -1456 176 -1504 176
WIRE -1360 176 -1456 176
WIRE -1168 176 -1168 64
WIRE -1168 176 -1280 176
WIRE -1072 176 -1168 176
WIRE 656 176 656 112
WIRE 992 176 992 144
WIRE 1152 176 1152 128
WIRE -896 192 -896 144
WIRE -896 192 -944 192
WIRE -2128 208 -2224 208
WIRE -1904 208 -2128 208
WIRE -1760 208 -1824 208
WIRE -1728 208 -1760 208
WIRE -1072 208 -1232 208
WIRE 16 224 -16 224
WIRE 128 224 96 224
WIRE 224 240 224 144
WIRE -2224 256 -2224 208
WIRE 0 256 -16 256
WIRE -1696 288 -1696 256
WIRE -1648 288 -1648 256
WIRE 1152 288 1152 256
WIRE -1760 304 -1760 208
WIRE 0 304 0 256
WIRE 656 304 656 240
WIRE 992 304 992 256
WIRE 128 320 128 224
WIRE 176 320 128 320
WIRE -1024 336 -1024 240
WIRE -992 336 -992 240
WIRE -992 336 -1024 336
WIRE -1024 352 -1024 336
WIRE 224 384 224 336
WIRE -2224 448 -2224 336
WIRE -1760 448 -1760 384
WIRE 336 560 336 464
WIRE 448 576 448 112
WIRE 448 576 384 576
WIRE 176 608 32 608
WIRE 256 608 176 608
WIRE -2224 624 -2224 528
WIRE -1760 624 -1760 528
WIRE 560 640 560 112
WIRE 560 640 384 640
WIRE 336 720 336 656
WIRE 176 832 176 688
WIRE 176 960 176 912
FLAG 992 304 0
FLAG 656 304 0
FLAG 992 -32 10V
FLAG 1152 288 0
FLAG 1152 128 7V
FLAG -448 48 7V
FLAG 224 384 0
FLAG 0 304 0
FLAG -336 -16 0
FLAG 1568 240 0
FLAG 1568 160 5V
FLAG -1024 112 5V
FLAG -1024 352 0
FLAG -1232 208 sens
FLAG 176 960 0
FLAG -1696 288 0
FLAG -1648 288 0
FLAG -1696 64 5V
FLAG 704 112 Vfb
FLAG -1952 -144 Vfb
FLAG -2224 624 0
FLAG -1952 144 0
FLAG -1760 624 0
FLAG 144 144 Sw
FLAG -768 144 PWM
FLAG -1456 176 EA
FLAG -2128 208 Vin
FLAG 336 720 0
FLAG 336 464 10V
FLAG 32 608 sens
DATAFLAG 208 608 ""
DATAFLAG -2080 208 ""
SYMBOL ind 336 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 2.5µH
SYMBOL voltage 992 160 R0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL voltage 992 0 R0
SYMATTR InstName V2
SYMATTR Value 5V
SYMBOL cap 640 176 R0
SYMATTR InstName C1
SYMATTR Value 800nF
SYMBOL res 544 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10m
SYMBOL voltage 1152 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 7 0 1u 0 10 20)
SYMBOL nmos 176 16 R0
SYMATTR InstName M1
SYMATTR Value IRLHS6376
SYMBOL nmos 176 240 R0
SYMATTR InstName M2
SYMATTR Value IRLHS6376
SYMBOL cap 80 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res -224 64 R90
WINDOW 0 11 63 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 27k
SYMBOL res -336 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100m
SYMBOL cap -352 -16 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL res -336 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1
SYMBOL res 112 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1
SYMBOL voltage 1568 144 R0
SYMATTR InstName V5
SYMATTR Value 5V
SYMBOL voltage 176 816 R0
SYMATTR InstName V4
SYMATTR Value 2.5V
SYMBOL res 896 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 3
SYMBOL Opamps\\LT6236 -1696 176 R0
SYMATTR InstName U3
SYMBOL res -1968 -112 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res -1664 16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value {10k*gm1}
SYMBOL voltage -2224 240 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(2.5 1 20k)
SYMBOL res -1808 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 5k
SYMBOL res -1744 400 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value {10k*gm1}
SYMBOL res -1968 16 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL voltage -2224 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PWL(10u 0 11u -4v 12u 4v 13u -4 14u 4 15u 0)
SYMBOL voltage -1760 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 2.5V
SYMBOL current-amp 336 624 M0
SYMATTR InstName X1
SYMBOL res 160 592 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL tlv3501 -1024 192 R0
SYMATTR InstName U4
SYMBOL TPS28225 -112 96 R0
SYMATTR InstName U5
SYMBOL res -1040 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 500Meg
SYMBOL res -1264 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
TEXT -656 408 Left 2 !.tran 100u
TEXT -664 432 Left 2 !.lib opamp.sub
TEXT -664 472 Left 2 !.param gm1=2
TEXT -1144 -56 Left 2 ;gm_comp = 1/rm = 10 A/V
TEXT -1136 -8 Left 2 ;gm_tot = A-fb * gm_comp
TEXT 312 784 Left 2 ;Iout 1mA @ sens 1V -> R7=1k.  Imax =>1V:  10A*r1*gm = 1mA -> R1 = 1ma / (1/100) *10A) = 10m
